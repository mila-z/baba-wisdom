{% extends 'base.html' %} {% block title %}View Wisdom{% endblock %}

{% block content %}
<h1 align="center">View Wisdom</h1>
<ul class="list-group list-group-flush" id="wisdom">
    {% for wisdom in wisdoms %}
    <li class="list-group-item" id="wisdom-{{ wisdom.id }}">
        <div class="d-flex justify-content-between align-items-center">
            <a href="{{ url_for('review.wisdom_reviews', wisdom_id=wisdom.id) }}">
                {{ wisdom.text }}
            </a>
            <button type="button" class="close" onClick="deleteWisdom('{{ wisdom.id }}')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        {% if wisdom.categories %}
            <hr class="my-2">
            <div>
                {% for category in wisdom.categories %}
                    <span class="badge badge-primary">{{ category.name }}</span>
                {% endfor %}
            </div>
        {% endif %}
    </li>
    {% endfor %}
</ul>

<script>
    function deleteWisdom(wisdomId) {
    console.log("hello, i am deleting now")

    fetch('/delete-wisdom', {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ wisdomId: wisdomId})
    }).then((response) => {
        if (response.ok) {
            const element = document.getElementById(`wisdom-${wisdomId}`);
            if (element) element.remove();
        } else {
            alert('Failed to delete wisdom.');
        }
    });
}
</script>
{% endblock %}