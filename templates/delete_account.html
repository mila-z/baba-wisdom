{% extends 'base.html' %} {% block title %}Delete account{% endblock %}

{% block content %}
<h1 align="center">Delete Account</h1>
<button id="delete-account-btn" class="btn btn-danger">
    Delete My Account
</button>

<script>
document.getElementById("delete-account-btn").addEventListener("click", function() {
    if (!confirm("Are you sure you want to delete your account? This cannot be undone.")) {
        return;
    }

    fetch("{{ url_for('auth.delete_account') }}", {
        method: "DELETE",
        headers: {
            "X-Requested-With": "XMLHttpRequest",
            "Content-Type": "application/json"
        }
    })
    .then(response => {
        if (response.ok) {
            alert("Your account has been deleted.");
            window.location.href = "{{ url_for('home.home') }}"; // redirect
        } else {
            alert("Something went wrong.");
        }
    })
    .catch(error => {
        console.error("Error:", error);
        alert("Request failed.");
    });
});
</script>
{% endblock %}